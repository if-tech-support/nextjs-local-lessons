## はじめに

アプリケーション全体で使用する共通レイアウトとコンポーネントを作成します。ヘッダーとフッターを配置し、認証状態に応じたナビゲーションを実装します。

## 目的

アプリケーション全体で使用する共通レイアウトとコンポーネントを作成し、認証状態に応じたナビゲーション機能を実装します。

## 学習対象のスキル

- Next.jsのレイアウト機能
- サーバーコンポーネントでの認証状態取得
- 条件付きレンダリング
- Tailwind CSSでのレスポンシブデザイン

## 課題A：レイアウトの設定（8分）

8分ほどヒントを参考にして仕様どおりにコーディングに挑戦し、その後に解答例で確認しましょう。

### 仕様

`layout.tsx`に共通レイアウトを設定し、ヘッダーとフッターを配置します。

- 編集するファイル: `src/app/layout.tsx`
- メタデータの設定: タイトル「AuthMini - 認証機能付きダッシュボード」、説明文を追加
- HTML言語設定: `lang="ja"`
- レイアウト構成: ヘッダー、メインコンテンツ、フッターの縦並び
- メインコンテンツ: `flex-1`で残り高さを占有
- フォント設定: Geistフォントの変数設定を維持

【使用タグ】
- `html`（最上位）
  - `body`（レイアウトコンテナー）
    - `Header`（ヘッダーコンポーネント）
    - `main`（メインコンテンツ）
    - `Footer`（フッターコンポーネント）

### ヒント

- Tailwindの例：`min-h-screen` `flex` `flex-col` `flex-1`
- メタデータは`Metadata`型を使用
- フォント変数は`className`で適用

### 解答例

```tsx
import type { Metadata } from "next";
import { Geist, Geist_Mono } from "next/font/google";
import "./globals.css";
import Header from "./components/Header";
import Footer from "./components/Footer";

const geistSans = Geist({
  variable: "--font-geist-sans",
  subsets: ["latin"],
});

const geistMono = Geist_Mono({
  variable: "--font-geist-mono",
  subsets: ["latin"],
});

export const metadata: Metadata = {
  title: "AuthMini - 認証機能付きダッシュボード",
  description: "Supabase Authenticationを使用した会員限定ダッシュボードアプリケーション",
};

export default function RootLayout({
  children,
}: Readonly<{
  children: React.ReactNode;
}>) {
  return (
    <html lang="ja">
      <body
        className={`${geistSans.variable} ${geistMono.variable} antialiased min-h-screen flex flex-col`}
      >
        <Header />
        <main className="flex-1">{children}</main>
        <Footer />
      </body>
    </html>
  );
}
```

## 課題B：ヘッダーコンポーネントの作成（12分）

12分ほどヒントを参考にして仕様どおりにコーディングに挑戦し、その後に解答例で確認しましょう。

### 仕様

認証状態に応じたナビゲーションを持つヘッダーコンポーネントを作成します。

- 作成するファイル: `src/app/components/Header.tsx`
- アプリタイトル: 「AuthMini」、クリックでトップページへ遷移
- ナビゲーション: 認証状態に応じて表示を切り替え
- 未認証時: 「ログイン」ボタン（青色背景）
- 認証時: 「ダッシュボード」リンク（グレー文字）
- レスポンシブ対応: 最大幅`max-w-7xl`、左右パディング`px-4 sm:px-6 lg:px-8`
- 高さ: `h-16`で固定

【使用タグ】
- `header`（最上位コンテナー）
  - `div`（コンテンツラッパー）
    - `div`（ロゴエリア）
      - `Link`（アプリタイトル）
    - `nav`（ナビゲーション）
      - `Link`（ダッシュボード/ログイン）

### ヒント

- Tailwindの例：`bg-white` `shadow-sm` `border-b` `flex` `justify-between` `items-center`
- 認証状態は`createClient`で取得
- 条件付きレンダリングでナビゲーションを切り替え

### 解答例

```tsx
import Link from "next/link";
import { createClient } from "@/lib/supabase/server";

export default async function Header() {
  const supabase = await createClient();
  const {
    data: { user },
  } = await supabase.auth.getUser();

  return (
    <header className="bg-white shadow-sm border-b">
      <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div className="flex justify-between items-center h-16">
          <div className="flex items-center">
            <Link href="/" className="text-xl font-bold text-gray-900">
              AuthMini
            </Link>
          </div>

          <nav className="flex items-center space-x-4">
            {user ? (
              <Link
                href="/dashboard"
                className="text-gray-700 hover:text-gray-900 px-3 py-2 rounded-md text-sm font-medium"
              >
                ダッシュボード
              </Link>
            ) : (
              <Link
                href="/login"
                className="bg-blue-600 text-white px-4 py-2 rounded-md text-sm font-medium hover:bg-blue-700"
              >
                ログイン
              </Link>
            )}
          </nav>
        </div>
      </div>
    </header>
  );
}
```

## 課題C：フッターコンポーネントの作成（5分）

5分ほどヒントを参考にして仕様どおりにコーディングに挑戦し、その後に解答例で確認しましょう。

### 仕様

シンプルなフッターコンポーネントを作成します。

- 作成するファイル: `src/app/components/Footer.tsx`
- 表示内容: 「© 2025 AuthMini」
- 背景色: 薄いグレー（`bg-gray-50`）
- 境界線: 上部にボーダー（`border-t`）
- レイアウト: 中央揃え、最大幅`max-w-7xl`
- パディング: 上下`py-4`、左右`px-4 sm:px-6 lg:px-8`

【使用タグ】
- `footer`（最上位コンテナー）
  - `div`（コンテンツラッパー）
    - `p`（コピーライトテキスト）

### ヒント

- Tailwindの例：`bg-gray-50` `border-t` `text-center` `text-sm` `text-gray-500`
- レスポンシブパディングを使用

### 解答例

```tsx
export default function Footer() {
  return (
    <footer className="bg-gray-50 border-t">
      <div className="max-w-7xl mx-auto py-4 px-4 sm:px-6 lg:px-8">
        <p className="text-center text-sm text-gray-500">© 2025 AuthMini</p>
      </div>
    </footer>
  );
}
```

## 課題D：トップページの認証状態による表示切り替え（7分）

7分ほどヒントを参考にして仕様どおりにコーディングに挑戦し、その後に解答例で確認しましょう。

### 仕様

認証状態に応じてトップページの表示を切り替えます。

- 編集するファイル: `src/app/page.tsx`
- 認証状態の確認: Supabaseクライアントでユーザー状態を取得
- ログイン済みの場合: 「ダッシュボードへ」ボタン（緑色）
- 未認証の場合: 「ログインへ」ボタン（青色）
- 条件分岐: `user`の有無で表示を切り替え

【使用タグ】
- `createClient`（Supabaseクライアント）
- `supabase.auth.getUser()`（認証状態取得）
- 条件分岐（`user ? ... : ...`）

### ヒント

- Server ComponentでSupabaseクライアントを使用
- 認証状態に応じてボタンの色とテキストを変更
- 緑色のボタンは`bg-green-600 hover:bg-green-700`

### 解答例

```tsx
import Link from "next/link";
import { createClient } from "@/lib/supabase/server";

export default async function Home() {
  const supabase = await createClient();
  const {
    data: { user },
  } = await supabase.auth.getUser();

  return (
    <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12 bg-white min-h-screen">
      <div className="text-center">
        <h1 className="text-4xl font-bold text-gray-900 sm:text-5xl md:text-6xl">
          AuthMini
        </h1>
        <p className="mt-3 max-w-md mx-auto text-base text-gray-500 sm:text-lg md:mt-5 md:text-xl md:max-w-3xl">
          認証機能付きダッシュボードアプリケーション
        </p>
        <p className="mt-3 max-w-md mx-auto text-sm text-gray-400 sm:text-base md:mt-5 md:text-lg md:max-w-3xl">
          Supabase
          Authenticationを使用して、安全で簡単なログイン機能を体験できます。
        </p>
        
        {user ? (
          // ログイン済みの場合
          <div className="mt-5 max-w-md mx-auto sm:flex sm:justify-center md:mt-8">
            <div className="rounded-md shadow">
              <Link
                href="/dashboard"
                className="w-full flex items-center justify-center px-8 py-3 border border-transparent text-base font-medium rounded-md text-white bg-green-600 hover:bg-green-700 md:py-4 md:text-lg md:px-10"
              >
                ダッシュボードへ
              </Link>
            </div>
          </div>
        ) : (
          // 未認証の場合
          <div className="mt-5 max-w-md mx-auto sm:flex sm:justify-center md:mt-8">
            <div className="rounded-md shadow">
              <Link
                href="/login"
                className="w-full flex items-center justify-center px-8 py-3 border border-transparent text-base font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 md:py-4 md:text-lg md:px-10"
              >
                ログインへ
              </Link>
            </div>
          </div>
        )}
      </div>
    </div>
  );
}
```

## 章末の確認

- ヘッダーにアプリタイトルとナビゲーションが表示される
- 認証状態に応じてナビゲーションが切り替わる
- トップページで認証状態に応じてボタンが切り替わる
- フッターにコピーライトが表示される
- レスポンシブデザインが適用されている
